## Project Name

`OptimalAir`

## Question Description

You are tasked with designing an intelligent air traffic control system for a busy metropolitan airport. The airport operates under strict noise regulations, and your system must minimize noise pollution while ensuring efficient flight operations.

The airport can be modeled as a graph where nodes represent airport gates and waypoints in the sky. Edges represent possible flight paths between these locations, each with an associated distance and *noise factor*. The noise factor represents the amount of noise generated by a flight along that path (higher value means more noise).

You are given a set of scheduled flights, each with a designated arrival gate. For each flight, your system must determine the optimal flight path from a designated starting waypoint (outside the city) to the assigned arrival gate, minimizing the *total noise* generated along the path.

However, there's a catch! The city is divided into noise-sensitive zones. Each zone has a defined maximum noise threshold. When calculating the total noise for a flight path, you must:

1.  Determine which noise-sensitive zones the path intersects. Assume you have a function `get_zones_intersected(path)` that takes a list of nodes representing a path and returns a list of zone IDs.

2.  Calculate the noise generated within each zone. Assume the noise is distributed proportionally to the edge lengths within the zone.

3.  If the noise generated within any zone exceeds the zone's threshold, you must add a penalty to the total noise of the path. The penalty is the square of the amount by which the threshold is exceeded, multiplied by a constant `PENALTY_MULTIPLIER`.

Your system must:

1.  Read the airport graph from a file. The file format is:
    ```
    <node1> <node2> <distance> <noise_factor>
    <node1> <node2> <distance> <noise_factor>
    ...
    ```
    Each line represents a directed edge from `node1` to `node2` with the given distance and noise factor.

2.  Read the zone information from another file. The file format is:
    ```
    <zone_id> <noise_threshold>
    <zone_id> <noise_threshold>
    ...
    ```
    Each line represents a noise-sensitive zone with its ID and noise threshold.

3.  Read the flight schedule from a third file. The file format is:
    ```
    <flight_id> <start_waypoint> <arrival_gate>
    <flight_id> <start_waypoint> <arrival_gate>
    ...
    ```
    Each line represents a flight with its ID, starting waypoint, and arrival gate.

4.  For each flight, find the path with the minimum total noise (including penalties for exceeding zone thresholds).

5.  Output the flight ID and the nodes constituting the optimal path for each flight to a file. The file format should be:
    ```
    <flight_id>: <node1>,<node2>,<node3>,...
    <flight_id>: <node1>,<node2>,<node3>,...
    ...
    ```

**Constraints:**

*   The number of nodes in the graph can be up to 1000.
*   The number of edges can be up to 5000.
*   The number of noise-sensitive zones can be up to 100.
*   The number of flights can be up to 1000.
*   Distances and noise factors are positive floating-point numbers.
*   Noise thresholds are positive floating-point numbers.
*   `PENALTY_MULTIPLIER` is a constant provided to your program.
*   You must find the optimal path for each flight within a reasonable time limit (e.g., 10 seconds per flight on a standard machine).

**Optimization Requirements:**

*   The primary goal is to minimize the total noise generated by all flights.
*   The solution should be computationally efficient to handle a large number of flights and complex airport graphs.

**Edge Cases and Constraints:**

*   Handle cases where no path exists between the starting waypoint and the arrival gate. Output "No path found" for such flights.
*   Handle cases where a flight path intersects multiple noise-sensitive zones.
*   Ensure that the noise calculation within each zone is accurate, considering the edge lengths.
*   Consider using efficient data structures and algorithms to optimize the pathfinding process (e.g., Dijkstra's algorithm with appropriate optimizations).
*   Handle floating-point precision issues carefully when calculating noise and penalties.

**System Design Aspects:**

*   The solution should be well-structured and modular, with clear separation of concerns.
*   The code should be readable and maintainable, with appropriate comments and documentation.

This problem requires a deep understanding of graph algorithms, data structures, and optimization techniques. It challenges the solver to design a practical and efficient solution for a real-world problem with complex constraints and edge cases. It allows for different approaches with trade-offs between time complexity, memory usage, and accuracy.
